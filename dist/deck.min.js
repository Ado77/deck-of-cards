"use strict";var Deck=function(){function t(t,e){var r=Date.now(),o=r+t,u=o+e,i={start:o,end:u};w.push(i),v||(v=!0,requestAnimationFrame(n));var c={start:function(t){return i.startcb=t,c},progress:function(t){return i.progresscb=t,c},end:function(t){return i.endcb=t,c}};return c}function n(){var t=Date.now();if(1e3/60>t-O)return void requestAnimationFrame(n);if(O=t,!w.length)return void(v=!1);for(var e,r=0;r<w.length;r++)if(e=w[r],!(t<e.start)){e.started||(e.started=!0,e.startcb&&e.startcb());var o=(t-e.start)/(e.end-e.start);e.progresscb&&e.progresscb(1>o?o:1),t>e.end&&(e.endcb&&e.endcb(),w.splice(r--,1))}requestAnimationFrame(n)}function e(t){if("undefined"!=typeof E[t])return E[t];if("undefined"!=typeof C[t])return E[t]=t,t;for(var n,e=t[0].toUpperCase()+t.slice(1),r=["webkit","moz","Moz","ms","o"],o=0,u=r.length;u>o;o++)if(n=r[o]+e,"undefined"!=typeof C[n])return E[t]=n,n}function r(t,n,e){return"undefined"!=typeof m||(m=o()),e=e||0,m?"translate3d("+t+", "+n+", "+e+")":"translate("+t+", "+n+")"}function o(){var t=e("transform"),n=document.createElement("p");return document.body.appendChild(n),n.style[t]="translate3d(1px,1px,1px)",m=n.style[t],m=null!=m&&m.length&&"none"!==m,document.body.removeChild(n),m}function u(t){var n=Math.round(Math.random())?-1:1;return n*t}function i(t){for(var n,e,r=t.length-1;r;r--)n=Math.random()*r|0,e=t[r],t[r]=t[n],t[n]=e;return t}function c(){return window.getComputedStyle(document.body).getPropertyValue("font-size").slice(0,-2)}function a(t){return t*Math.PI/180}function s(t){return document.createElement(t)}function f(t){function n(t){t.card&&t.card(w)}function o(t){function n(t){k&&("mousemove"===t.type?(u.x=t.clientX,u.y=t.clientY):(u.x=t.touches[0].clientX,u.y=t.touches[0].clientY),m.style[f]=r(Math.round(w.x+u.x-o.x)+"px",Math.round(w.y+u.y-o.y)+"px")+(w.rot?" rotate("+w.rot+"deg)":""))}function e(t){q&&Date.now()-i<200&&w.setSide("front"===w.side?"back":"front"),"mouseup"===t.type?(p(window,"mousemove",n),p(window,"mouseup",e)):(p(window,"touchmove",n),p(window,"touchend",e)),k&&(w.x=w.x+u.x-o.x,w.y=w.y+u.y-o.y)}var o={},u={},i=Date.now();t.preventDefault(),"mousedown"===t.type?(o.x=u.x=t.clientX,o.y=u.y=t.clientY,l(window,"mousemove",n),l(window,"mouseup",e)):(o.x=u.x=t.touches[0].clientX,o.y=u.y=t.touches[0].clientY,l(window,"touchmove",n),l(window,"touchend",e)),k&&(m.style[f]=r(w.x+"px",w.y+"px")+(w.rot?" rotate("+w.rot+"deg)":""),m.style.zIndex=L++)}function u(t){t.appendChild(m),w.$root=t}function i(){w.$root&&w.$root.removeChild(m),w.$root=null}function c(t){"front"===t?("back"===w.side&&m.removeChild(b),w.side="front",m.appendChild(g),w.setRankSuit(w.rank,w.suit)):("front"===w.side&&m.removeChild(g),w.side="back",m.appendChild(b),m.setAttribute("class","card"))}var a,f=e("transform"),y=t%13+1,x=t/13|0,v=(52-t)/4,m=s("div"),g=s("div"),b=s("div"),k=!1,q=!1,w={i:t,rank:y,suit:x,pos:t,$el:m,mount:u,unmount:i,setSide:c},O=h.modules;g.classList.add("face"),b.classList.add("back"),m.style[f]=r(-v+"px",-v+"px"),w.x=-v,w.y=-v,w.z=v,w.rot=0,w.setSide("back"),l(m,"mousedown",o),l(m,"touchstart",o);for(a in O)n(O[a]);return w.setRankSuit=function(t,n){var e=d(n);m.setAttribute("class","card "+e+" rank"+t)},w.setRankSuit(y,x),w.enableDragging=function(){k||(k=!0,m.style.cursor="move")},w.enableFlipping=function(){q||(q=!0)},w.disableFlipping=function(){q&&(q=!1)},w.disableDragging=function(){k&&(k=!1,m.style.cursor="")},w}function d(t){return 0===t?"spades":1===t?"hearts":2===t?"clubs":3===t?"diamonds":"joker"}function l(t,n,e){t.addEventListener(n,e)}function p(t,n,e){t.removeEventListener(n,e)}function y(t){function n(t){return function(){var n=this,r=arguments;e(function(e){t.apply(n,o.concat.apply(e,r))})}}function e(t){t&&(u.push(t),1===u.length&&r())}function r(){u[0](function(t){if(t)throw t;u=u.slice(1),u.length&&r()})}var o=Array.prototype,u=[];return t.queue=e,t.queued=n,t}function x(t){function n(t,n,e){u[t]||(u[t]=[]),u[t].push({cb:n,ctx:e})}function e(t,n,e){u[t]||(u[t]=[]),u[t].push({cb:n,ctx:e,once:!0})}function r(t){var n=this,e=Array.prototype.slice(arguments,1),r=u[t]||[];r.filter(function(t){return t.cb.apply(n,e),!t.once})}function o(t,n){return t?n?void(u[t]=u[t].filter(function(t){return t.cb!==n})):void(u[t]=[]):void(u={})}t||(t={});var u={};return t.on=n,t.one=e,t.off=o,t.trigger=r,t}function h(t){function n(t){o=t,o.appendChild(c)}function e(){o.removeChild(c)}function r(t){t.deck&&t.deck(a)}var o,u,i=new Array(t?55:52),c=s("div"),a=x({mount:n,unmount:e,cards:i,$el:c}),d=h.modules;y(a);for(u in d)r(d[u]);c.classList.add("deck");for(var l,p=i.length;p;p--)l=i[p-1]=f(p-1),l.mount(c);return a}var v,m,g,b,k,q,w=[],O=0,I={linear:function(t){return t},quadIn:function(t){return t*t},quadOut:function(t){return t*(2-t)},quadInOut:function(t){return.5>t?2*t*t:-1+(4-2*t)*t},cubicIn:function(t){return t*t*t},cubicOut:function(t){return--t*t*t+1},cubicInOut:function(t){return.5>t?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},quartIn:function(t){return t*t*t*t},quartOut:function(t){return 1- --t*t*t*t},quartInOut:function(t){return.5>t?8*t*t*t*t:1-8*--t*t*t*t},quintIn:function(t){return t*t*t*t*t},quintOut:function(t){return 1+--t*t*t*t*t},quintInOut:function(t){return.5>t?16*t*t*t*t*t:1+16*--t*t*t*t*t}},M={deck:function(t){function n(n){var e=t.cards.filter(function(t){return"front"===t.side}).length/t.cards.length;t.cards.forEach(function(t,n){t.setSide(e>.5?"back":"front")}),n()}t.flip=t.queued(n)}},C=document.createElement("p").style,E={},$={deck:function(t){function n(n,e){var r=t.cards;r.sort(function(t,n){return e?t.i-n.i:n.i-t.i}),r.forEach(function(t,o){t.sort(o,r.length,function(t){t===r.length-1&&n()},e)})}t.sort=t.queued(n)},card:function(n){var o=e("transform"),u=n.$el;n.sort=function(e,i,c,a){var s,f,d,l,p,y,x=e/4,h=10*e;t(h,400).start(function(){s=n.x,f=n.y,d=n.rot,l=-x-s,p=-150-f,y=0-d}).progress(function(t){t=I.quadOut(t),n.x=s+l*t,n.y=f+p*t,n.rot=d+y*t,u.style[o]=r(n.x+"px",n.y+"px")+(n.rot?" rotate("+n.rot+"deg)":"")}).end(function(){u.style.zIndex=e}),t(h+500,400).start(function(){f=n.y,p=-x-f}).progress(function(t){t=I.quadOut(t),n.y=f+p*t,u.style[o]=r(-x+"px",n.y+"px")}).end(function(){c(e)})}}},S={deck:function(t){function n(n){var e=t.cards;g=c(),i(e),e.forEach(function(t,r){t.pos=r,t.shuffle(function(t){t===e.length-1&&n()})})}t.shuffle=t.queued(n)},card:function(n){var o=e("transform"),i=n.$el;n.shuffle=function(e){var c,a,s,f,d,l,p=n.pos,y=p/4,x=u(40*Math.random()+20)*g/16,h=2*p;t(h,200).start(function(){c=n.x,a=n.y,s=n.rot||0,f=x-c,d=-y-a,l=0-s}).progress(function(t){t=I.quadOut(t),n.x=c+f*t,n.y=a+d*t,n.rot=s+l*t,i.style[o]=r(n.x+"px",n.y+"px")+(n.rot?" rotate("+n.rot+"deg)":"")}),t(200+h,200).start(function(){c=n.x,a=n.y,s=n.rot||0,f=-y-c,d=-y-a,l=0-s,i.style.zIndex=p}).progress(function(t){t=I.quadOut(t),n.x=c+f*t,n.y=a+d*t,n.rot=s+l*t,i.style[o]=r(n.x+"px",n.y+"px")+(n.rot?" rotate("+n.rot+"deg)":"")}).end(function(){setTimeout(function(){e(p)},0)})}}},z={deck:function(t){function n(n){var e=t.cards,r=e.length;b=c(),e.slice(-5).reverse().forEach(function(t,e){t.poker(e,r,function(e){t.setSide("front"),4===e&&n()})})}t.poker=t.queued(n)},card:function(n){var o=e("transform"),u=n.$el;n.poker=function(e,i,c){var a,s,f,d,l,p,y=250*e,x={x:Math.round(70*(e-2.05)*b/16),y:Math.round(-110*b/16)};t(y,250).start(function(){a=n.x,s=n.y,f=n.rot||0,d=x.x-a,l=x.y-s,p=0-f,u.style.zIndex=i-1+e}).progress(function(t){t=I.quadOut(t),n.x=a+d*t,n.y=s+l*t,n.rot=f+p*t,u.style[o]=r(n.x+"px",n.y+"px")+(n.rot?" rotate("+n.rot+"deg)":"")}).end(function(){c(e)})}}},A={deck:function(n){function e(e){var r=n.cards;r.forEach(function(n,o){n.setSide("front"),n.intro(o,function(o){t(250,0).start(function(){n.setSide("back")}),o===r.length-1&&e()})})}n.intro=n.queued(e)},card:function(n){var o=e("transform"),u=n.$el;n.intro=function(e,i){var c=500+10*e,a=e/4;u.style[o]=r(-a+"px","-250px"),u.style.opacity=0,n.x=-a;var s=-a- -250;t(c,1e3).start(function(){u.style.zIndex=e}).progress(function(t){u.style.opacity=t,t=I.quartOut(t),n.y=-250+s*t,u.style[o]=r(-a+"px",n.y+"px")}).end(function(){u.style.opacity="",i&&i(e)})}}},D={deck:function(t){function n(n){var e=t.cards,r=e.length;k=c(),e.forEach(function(t,o){t.fan(o,r,function(t){t===e.length-1&&n()})})}t.fan=t.queued(n)},card:function(n){var o=e("transform"),u=n.$el;n.fan=function(e,i,c){var s,f,d,l,p,y,x=e/4,h=10*e,v=e/(i-1)*260-130;t(h,300).start(function(){s=n.x,f=n.y,d=n.rot||0,l=-x-s,p=-x-f,y=0-d}).progress(function(t){t=I.quadOut(t),n.x=s+l*t,n.y=f+p*t,n.rot=d+y*t,u.style[o]=r(n.x+"px",n.y+"px")+(n.rot?" rotate("+n.rot+"deg)":"")}),t(300+h,300).start(function(){s=n.x,f=n.y,d=n.rot||0,l=55*Math.cos(a(v-90))*k/16-s,p=55*Math.sin(a(v-90))*k/16-f,y=v-d}).progress(function(t){t=I.quadOut(t),n.x=s+l*t,n.y=f+p*t,n.rot=d+y*t,u.style[o]=r(n.x+"px",n.y+"px")+(n.rot?" rotate("+n.rot+"deg)":"")}).end(function(){c(e)})}}},F={deck:function(t){function n(n){var e=t.cards;q=c(),e.forEach(function(t){t.bysuit(function(t){t===e.length-1&&n()})})}t.bysuit=t.queued(n)},card:function(n){var o=e("transform"),u=n.rank,i=n.suit,c=n.$el;n.bysuit=function(e){var a,s,f,d,l,p,y=n.i,x=10*y,h=-Math.round(8*(6.75-u)*q/16),v=-Math.round(92*(1.5-i)*q/16);t(x,400).start(function(){a=n.x,s=n.y,l=n.rot||0,f=h-a,d=v-s,p=0-l}).progress(function(t){t=I.quadOut(t),n.x=a+f*t,n.y=s+d*t,n.rot=l+p*t,c.style[o]=r(n.x+"px",n.y+"px")+(n.rot?" rotate("+n.rot+"deg)":"")}).end(function(){e(y)})}}},L=52;return h.animationFrames=t,h.ease=I,h.modules={bysuit:F,fan:D,intro:A,poker:z,shuffle:S,sort:$,flip:M},h.Card=f,h.prefix=e,h.translate=r,h}();